{
  "info": {
    "author": "Simon Norris",
    "author_email": "snorris@hillcrestgeo.ca",
    "bugtrack_url": null,
    "classifiers": [
      "Development Status :: 3 - Alpha",
      "Intended Audience :: Developers",
      "License :: OSI Approved :: MIT License",
      "Operating System :: OS Independent",
      "Programming Language :: Python :: 2.7",
      "Programming Language :: Python :: 3.3",
      "Programming Language :: Python :: 3.4",
      "Programming Language :: Python :: 3.5",
      "Programming Language :: Python :: 3.6"
    ],
    "description": "# pgdata\n\nPython PostgreSQL-PostGIS-SQLAlchemy shortcuts.\n\n[![Build Status](https://travis-ci.org/smnorris/pgdata.svg?branch=master)](https://travis-ci.org/smnorris/pgdata) [![Coverage Status](https://coveralls.io/repos/github/smnorris/pgdata/badge.svg?branch=master)](https://coveralls.io/github/smnorris/pgdata?branch=master)\n\npgdata is a collection of convenience functions for working with PostgreSQL:\n\n- provides an dictionary/JSON-like shortcut interface to database objects without dealing directly with an ORM or cursor (see [dataset](https://dataset.readthedocs.io/en/latest/))\n\n        >>> import pgdata\n        >>> db = pgdata.connect()\n        >>> db.tables\n        ['inventory']\n        >>> db[\"inventory\"].columns\n        ['type', 'supplier', 'cost']\n\n- provides a shortcut to `ogr2ogr` for quickly getting geographic data in and out of your database with sensible defaults and without resorting to shell scripting\n\n\n        >>> import pgdata\n        >>> db = pgdata.connect()\n        >>> db.ogr2pg('airports.shp', \n                      out_layer='airports_a',\n                      schema='airport_project')\n        >>> db.execute('do stuff')\n        >>> db.pg2ogr('SELECT * FROM airports_project.result','GPKG', 'output.gpkg')\n\n\nMuch is copied directly from [dataset](https://dataset.readthedocs.org/) and further inspiration was taken from [pgwrap](https://github.com/paulchakravarti/pgwrap).\n\n## Requirements\n\n- PostgreSQL\n- PostGIS\n- GDAL (optional, for `pg2ogr` and `ogr2pg`)\n- [ESRI File Geodatabase API](http://appsforms.esri.com/products/download/) (optional, for using `pg2ogr` with `FileGDB` option)\n\n## Installation\n\n```\npip install pgdata\n```\n\n## Configuration\n\nCreate an environment variable `DATABASE_URL` and set it to the [SQLAlchemy db url](http://docs.sqlalchemy.org/en/latest/core/engines.html) for your database:\n\nMacOS/Linux etc: \n\n`export DATABASE_URL=postgresql://postgres:postgres@localhost:5432/mydb`\n\nWindows: \n\n`SET DATABASE_URL=\"postgresql://postgres:postgres@localhost:5432/mydb\"`\n\n\n## Usage\n\n```\n>>> import pgdata\n>>> db = pgdata.connect(schema='myschema')\n>>> db.tables\n['inventory']\n>>> db[\"inventory\"].columns\n['type', 'supplier', 'cost']\n>>> data = db.query(\"SELECT * FROM inventory WHERE type = %s\", ('spam',)).fetchall()\n>>> for row in data:\n>>>     print (row['type'], row['supplier'], row['cost'])\n('spam', 'spamcorp', 100)\n>>> for row in db[\"inventory\"].find(type='spam'):\n>>>     print (row['type'], row['supplier'], row['cost'])\n('spam', 'spamcorp', 100)\n```\n\n\n## Paired with [`bcdata`](https://github.com/smnorris/bcdata)\n\nTry some basic spatial analysis - how many airports are in the CRD?\n\n```\nimport os\n\nimport bcdata\nimport pgdata\n\n# define data to download\nairports = 'bc-airports'\nregdist = 'regional-districts-legally-defined-administrative-areas-of-bc'\n\n# connect to default database, as defined by $DATABASE_URL\ndb = pgdata.connect()\n\n# download and load to postgres\nfor url in [airports, regdist]:\n    # what are the official schema and table names of the data source?\n    info = bcdata.info(url)\n    schema, table = (info['schema'], info['name'])\n\n    # grab default email address for DataBC downloads\n    email = os.environ['BCDATA_EMAIL']\n\n    # download the data and use pgdata's ogr2pg shortcut to load to postgres\n    # Note that we assume that the name of the layer in downloaded .gdb \n    # is 'schema_table'\n    dl = bcdata.download(url, email)\n    db.create_schema(schema)\n    db.ogr2pg(dl, in_layer=schema+'_'+table, out_layer=table, schema=schema)\n\n# define the query\nsql = \"\"\"SELECT COUNT(*)\n         FROM whse_imagery_and_base_maps.gsr_airports_svw a\n         INNER JOIN whse_legal_admin_boundaries.abms_regional_districts_sp rd\n         ON ST_Intersects(a.geom, rd.geom)\n         WHERE rd.admin_area_name = 'Capital Regional District'\n      \"\"\"\n\n# execute and print results\nprint(db.query(sql).fetchone()[0])\n\n```\n\n## bc2pg\n\nThe module includes `bc2pg`, a command line tool that operates as a shortcut for the `bcdata` operations above:\n\n```\n$ bc2pg --help\nUsage: bc2pg [OPTIONS] DATASET\n\n  Mirror a DataBC Catalogue dataset in postgres\n\nOptions:\n  --email TEXT   Email address. Default: $BCDATA_EMAIL\n  --db_url TEXT  Target database Default: $DATABASE_URL\n  --help         Show this message and exit.\n```\n\nTo download bc-airports and load to postgres table `whse_imagery_and_base_maps.gsr_airports_svw`:\n\n`$ bc2pg bc-airports`\n\n",
    "docs_url": null,
    "download_url": "",
    "downloads": {
      "last_day": 0,
      "last_month": 0,
      "last_week": 0
    },
    "home_page": "https://github.com/smnorris/pgdata",
    "keywords": "postgresql postgis shortcuts data BC ogr2ogr gdal gis",
    "license": "MIT",
    "maintainer": "",
    "maintainer_email": "",
    "name": "pgdata",
    "platform": "",
    "project_url": "https://pypi.org/project/pgdata/",
    "release_url": "https://pypi.org/project/pgdata/0.0.6/",
    "requires_dist": [
      "fiona; extra == 'test'",
      "coverage; extra == 'test'",
      "pytest; extra == 'test'",
      "bcdata",
      "alembic",
      "geoalchemy2",
      "sqlalchemy-utils",
      "sqlalchemy",
      "psycopg2"
    ],
    "requires_python": "",
    "summary": "Postgresql shortcuts",
    "version": "0.0.6"
  },
  "releases": {
    "0.0.5": [
      {
        "comment_text": "",
        "digests": {
          "md5": "9a0ab35fcdd2aca9df6507dd6f29af1e",
          "sha256": "74c4331381bfa9b877c88b41364e4e3b986a5343da3d8edf2d7718e04f1ad572"
        },
        "downloads": -1,
        "filename": "pgdata-0.0.5-py2.py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "9a0ab35fcdd2aca9df6507dd6f29af1e",
        "packagetype": "bdist_wheel",
        "python_version": "py2.py3",
        "size": 13500,
        "upload_time": "2018-01-12T23:18:24",
        "url": "https://files.pythonhosted.org/packages/08/2f/e7c5c2aa0df01e7a0740cec0f8ed59079c3b8b7f06e62c9aa12e414a8d7a/pgdata-0.0.5-py2.py3-none-any.whl"
      },
      {
        "comment_text": "",
        "digests": {
          "md5": "490c0549d2a0af244e3f394789d95940",
          "sha256": "203d186bbaab838bf0d291e78c0a3545cdc8e420c08dda6938dbd8e0f93acc47"
        },
        "downloads": -1,
        "filename": "pgdata-0.0.5.tar.gz",
        "has_sig": false,
        "md5_digest": "490c0549d2a0af244e3f394789d95940",
        "packagetype": "sdist",
        "python_version": "source",
        "size": 54657,
        "upload_time": "2018-01-12T23:18:26",
        "url": "https://files.pythonhosted.org/packages/f9/22/7771ea48277de25522a04042e000d07d9181d6c73a93641e5479b4243447/pgdata-0.0.5.tar.gz"
      }
    ],
    "0.0.5.dev0": [
      {
        "comment_text": "",
        "digests": {
          "md5": "b9544f2beb18d01a16be1c3660383d2c",
          "sha256": "7ebcce96d349092da6382091afb653240c6db94083778590502a06f0e5cacd26"
        },
        "downloads": -1,
        "filename": "pgdata-0.0.5.dev0-py2.py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "b9544f2beb18d01a16be1c3660383d2c",
        "packagetype": "bdist_wheel",
        "python_version": "py2.py3",
        "size": 13576,
        "upload_time": "2018-01-12T23:09:20",
        "url": "https://files.pythonhosted.org/packages/e0/95/05fdbcaae7107776b9ecae8f764ddc8639c051638ac918a7d971ce981ec0/pgdata-0.0.5.dev0-py2.py3-none-any.whl"
      },
      {
        "comment_text": "",
        "digests": {
          "md5": "c7a49ef76ddadb8a285ac43984f3e392",
          "sha256": "932be0e24841836361ef1d5a75ba78658cd3c062e4c3bec7409aae9a9d6f33e7"
        },
        "downloads": -1,
        "filename": "pgdata-0.0.5.dev0.tar.gz",
        "has_sig": false,
        "md5_digest": "c7a49ef76ddadb8a285ac43984f3e392",
        "packagetype": "sdist",
        "python_version": "source",
        "size": 54690,
        "upload_time": "2018-01-12T23:09:22",
        "url": "https://files.pythonhosted.org/packages/0c/d1/e8431e6619111fb8ce55d030de5beb0d2af8d8e9fda167f7cb0b3244cef6/pgdata-0.0.5.dev0.tar.gz"
      }
    ],
    "0.0.6": [
      {
        "comment_text": "",
        "digests": {
          "md5": "bfdfb453392983b77af09b12be9bda94",
          "sha256": "0cc97b1a00e98d8fdfe06338549770c25f729eb034a2b81d6edad95b0a8714ea"
        },
        "downloads": -1,
        "filename": "pgdata-0.0.6-py2.py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "bfdfb453392983b77af09b12be9bda94",
        "packagetype": "bdist_wheel",
        "python_version": "py2.py3",
        "size": 17120,
        "upload_time": "2018-01-20T07:02:23",
        "url": "https://files.pythonhosted.org/packages/e1/63/2dc332288ff916d410f51ae1a2cc57f3b6b73393ddc177824a828c2ec066/pgdata-0.0.6-py2.py3-none-any.whl"
      },
      {
        "comment_text": "",
        "digests": {
          "md5": "b48cbb7b66ef9617889d5bfd7ee7d031",
          "sha256": "9cdc75f7863b3270339d426f163a9a01a3f04da1daabe35bcc0d565bed981b26"
        },
        "downloads": -1,
        "filename": "pgdata-0.0.6.tar.gz",
        "has_sig": false,
        "md5_digest": "b48cbb7b66ef9617889d5bfd7ee7d031",
        "packagetype": "sdist",
        "python_version": "source",
        "size": 56971,
        "upload_time": "2018-01-20T07:02:25",
        "url": "https://files.pythonhosted.org/packages/a5/99/22fda8bbf024a00bb022e4d55b018f6a47f13ccbed974eecce9d7e63f287/pgdata-0.0.6.tar.gz"
      }
    ]
  },
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "md5": "bfdfb453392983b77af09b12be9bda94",
        "sha256": "0cc97b1a00e98d8fdfe06338549770c25f729eb034a2b81d6edad95b0a8714ea"
      },
      "downloads": -1,
      "filename": "pgdata-0.0.6-py2.py3-none-any.whl",
      "has_sig": false,
      "md5_digest": "bfdfb453392983b77af09b12be9bda94",
      "packagetype": "bdist_wheel",
      "python_version": "py2.py3",
      "size": 17120,
      "upload_time": "2018-01-20T07:02:23",
      "url": "https://files.pythonhosted.org/packages/e1/63/2dc332288ff916d410f51ae1a2cc57f3b6b73393ddc177824a828c2ec066/pgdata-0.0.6-py2.py3-none-any.whl"
    },
    {
      "comment_text": "",
      "digests": {
        "md5": "b48cbb7b66ef9617889d5bfd7ee7d031",
        "sha256": "9cdc75f7863b3270339d426f163a9a01a3f04da1daabe35bcc0d565bed981b26"
      },
      "downloads": -1,
      "filename": "pgdata-0.0.6.tar.gz",
      "has_sig": false,
      "md5_digest": "b48cbb7b66ef9617889d5bfd7ee7d031",
      "packagetype": "sdist",
      "python_version": "source",
      "size": 56971,
      "upload_time": "2018-01-20T07:02:25",
      "url": "https://files.pythonhosted.org/packages/a5/99/22fda8bbf024a00bb022e4d55b018f6a47f13ccbed974eecce9d7e63f287/pgdata-0.0.6.tar.gz"
    }
  ]
}