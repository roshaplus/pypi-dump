{
  "info": {
    "author": "Liam H. Childs",
    "author_email": "liam.h.childs@gmail.com",
    "bugtrack_url": null,
    "classifiers": [],
    "description": "[![Build Status](https://travis-ci.org/childsish/sofia.svg?branch=master)](https://travis-ci.org/childsish/sofia)\n\nSoFIA\n=====\n\nSoftware for the Flexible Integration of Annotation (SoFIA) is a framework designed to make integrating information from multiple sources as easy and painless as possible. This is achieved through the use of a worflow engine capable of automatically resolving a workflow dedicated toward fulfilling a particular purpose from a parent template. In practice, this means that the user only needs to provide the resources they wish to draw their information from and the entities they wish to associate with their resources, and the framework will do the rest.\n\nBy default, vanilla SoFIA comes with a genomics workflow, capable of annotating variants and genes, and calculating sequence features. If different functionality is required, SoFIA has been designed to be extensible allowing the user to easily extend the current workflow or even create a whole new workflow for completely different purposes.\n\nThere is a [Google Group][google-group] for discussions about SoFIA.  \n\nInstallation\n------------\n\nSoFIA requires [Python 2.7][python] to be installed with the pip package management system. Pip should come with the latest Python.\n\n1. Open the command line with administrator priveleges (Powershell in Windows, Shell in Linux)\n2. Update pip:\n  * Windows: `python -m pip install -U pip setuptools`\n  * Linux: `pip install -U pip setuptools`\n3. Install SoFIA:\n  * Windows: `python -m pip install sofia`\n  * Linux: `pip install sofia`\n\nRunning SoFIA\n-------------\n\nWe provide example data to help familiarise yourself with SoFIA. To get the data, run:\n\n```\npython -m sofia get http://childsish.github.io/static/sofia/example.tar.gz\n```\n\nThis will create a directory wherever you run the command.\n\nTo try the example, run:\n\n```\npython -m sofia aggregate ./example/data/randome.vcf -e chromosome_id -e position -e gene_id -e amino_acid_variant -e variant_effect -r ./example/data/randome.gff -r ./example/data/randome.fasta -o output.txt -p 1\n```\n\nThe command line can be broken down into several parts:\n\n1. `python -m sofia` Call the SoFIA script.\n2. `aggregate` Run SoFIA in data aggregation mode.\n2. `./data/example/randome.vcf` Annotate a set of variants.\n3. `-e chromosome_id -e position -e gene_id -e amino_acid_variant -e variant_effect` Annotate each variant with the chromosome, position, gene name, amino acid variant and variant effect. \n4. `-r ./data/example/randome.gff -r ./data/example/randome.fasta` Use a set of genes descriptions and chromosome sequences to provide the extra information needed to generate the requested entities.\n\nThe output will be placed in the current directory in the `output.txt` file. To check if you got the correct output, run:\n\n```\ndiff ./example/data/output.txt output.txt\n```\n\n### Data download scripts\n\nSoFIA does not package any further data internally as you know best what is required your own analyses. However, to help you get started, we provide shell scripts in the `scripts` directory that download the basic necessities for annotation. If you wish for further \"standard\" annotation sets to be added, please let us know the url of each file or provide us a shell script and we will consider adding it to the default SoFIA installation.\n\nAvailable:\n * GRCh37 version of the human genome\n\nUsing the API\n-------------\n\nSoFIA can also be used programatically. All output will be automatically printed to standard output.\n\n1. Create provided resources\n\n```python\n\n    from sofia_.subcommands import get_provided_entities\n    \n    provided_entities = get_provided_entities([\n        '/absolute/path/to/target/file.extension:target',\n        '/absolute/path/to/sequence/file.fasta',\n        '/absolute/path/to/feature/file.gtf'\n    ])\n```\n\n2. Create requested entities\n\n```python\n\n    from sofia_.subcommands import get_requested_entities\n    \n    requested_entities = get_requested_entities([\n        'gene_name',\n        'amino_acid_variant',\n        'variant_effect'\n    ])\n\n```\n\n3. Create the template\n\n```python\n\n    from sofia_.template_factory import TemplateFactory\n    \n    template_factory = TemplateFactory('/absolute/path/to/template_directory')\n    template = template_factor.make(provided_entities, requested_entities)\n    \n```\n\n4. Call the aggregator\n\n```python\n \n    from collections import namedtuple\n    from sofia_.subcommands.aggregate import Aggregator\n    \n    Arguments = namedtuple('Arguments', ['header', 'template', 'processes', 'simultaneous_entries'])\n    aggregator = Aggregator(template, 'template_directory')\n    aggregator.aggregate(requested_entities, provided_entities, Arguments(None, None, 1, None))\n     \n```\n\nDefining a template\n-------------------\n\nTemplates are found in the `sofia/templates` directory. Each template has a directory with it's own name. There are three main locations in the template's directory.\n\n1. `sofia/templates/<template_name>/steps`. All steps are defined in this directory.\n2. `sofia/templates/<template_name>/entities.json`. Complex entity relationships are defined in this file.\n3. `sofia/templates/<template_name>/data`. Default data for the template is placed in this directory.\n\n### Defining steps\n\nNew steps are implemented by creating a new Python class that inherits from the `Step` class found in modules.step. A step consists of several concepts.\n\n1. **The name of the step.** This is the name that is referred to from the command line and other steps. It is defined by the name of the class.\n2. **Required entities.** A list of entities that the step will use. Required entities are defined by the class variable \"IN\".\n3. **Provided entities.** A list of entities that the step will provide. Provided entities are defined by the class variable \"OUT\".\n4. **Calculating the step.** The function to actually calculate the desired step also needs to be defined. The arguments that are passed to it are determined by the names of the given dependencies. The function is defined by the class member \"calculate\".\n\nExample:\n```python\n\n    from sofia_.step import Step\n\n    class GetCodonUSage(Step):\n\n        IN = ['coding_sequence']\n        OUT = ['codon_usage']\n\n        def calculate(self, coding_sequence):\n            codon_usage = {}\n            for i in xrange(0, len(coding_sequence), 3):\n                codon = coding_sequence[i:i+3]\n                if codon not in codon_usage:\n                    codon_usage[codon] = 0\n                codon_usage[codon] += 1\n            return codon_usage\n```\n\n### Defining resources\n\nResources are practically identical to steps, but they have no incoming entities and some extra details to match them to provided filenames is required. \n\n### Defining entities\n\nNew entities are just as simple to create. Any entities declared by the step (in the IN and OUT member variables) are automatically created. If complex relationships among the entities need to be defined, then the `entities.json` is used for this purpose.\n\nThe root json object is an array in which several associative arrays can be stored, each representing an entity with complex relationships. The entity is defined by the following key:pair values:\n\n* **name**. This is the name of the entity that the framework uses to identify it. The current format for the name is underscore separated, lower-case words.\n* **is_a** (optional). This is the name of a single other entity that this entity can be considered equivalent to. This equivalency is not bi-directional (e.g. a `variant` can be considered a `genomic_position` but a `genomic_position` can not be used as a `variant`).\n* **has_a** (optional). This is a set of the other entities that this entity contains. It is implemented as an array of associative arrays where the associative array describes how to access the contained entity:\n    * **name**. The name that the framework uses to identify the child entity.\n    * **key**. The key that is used by the Python object to access the child entity.\n    * **type**. The type of access to the child entity required. If it is an attibute of an object then this values should be `attr`. If it is a key in a dictionary then this value should be `item`.\n* **description** (optional). A description of the entity used by the `sofia info` command.\n\nExample:\n```json\n\n[\n  {\n    \"name\": \"genomic_feature\",\n    \"is_a\": \"genomic_interval\",\n    \"has_a\": [\n      { \"name\": \"gene_id\", \"key\": \"name\", \"type\": \"attr\" }\n    ],\n    \"description\": \"A model of transcribed DNA. This includes all alternative transcripts.\"\n  }\n]\n```\n\nDesign Philosophy\n-----------------\n\nBatteries included.\n\n * There should be as few library dependencies as possible.\n\nThe user has to change the resource data as little as possible.\n \n * Ideally, all files can be used as-is. However, indexing the file is highly recommended as it will greatly speed up the framework. Indexing using the [htslib][htslib] is supported by default.\n\nThe tool should be easily extended.\n\n * The default state is not a one-size-fits-all solution. Different groups have different needs. However, it should be easily extended to accomodate new types of resources and steps.\n\n\nStandardisation (Variant annotation)\n------------------------------------\n\nThe genomic template that comes with SoFIA will use the major transcript when finding the variant effect on a gene. The major transcript is defined as the longest transcript (in coding nucleotides).\n\nThe template attempts to follow the guidelines laid out by the [Human Genome Variation Society][hgvs] when showing the coding and amino acid changes. However, we deviate from the guidelines by using only the 1-letter code for amino acids. Any other deviation is unintentional and should be brought to my attention.\n\nThe template also attempts to follow the [The Sequence Ontology][so] when describing the type of variant. Any deviation is unintentional and should be brought to my attention.\n\n\nTo Do\n-----\n\nThere are still many ways in which SoFIA can be improved. Here are some that I plan to do, but I am always open to suggestions.\n\nRefer to the GitHub [issues][issues] page for upcoming improvements, to make suggestions and bug submissions.\n\n[python]: https://www.python.org/downloads/ \"Download Python 2.7\"\n[hgvs]: http://www.hgvs.org/mutnomen/ \"Human Genome Variation Society\"\n[so]: http://www.sequenceontology.org/ \"The Sequence Ontology\"\n[issues]: https://github.com/childsish/sofia/issues \"To Do\"\n[google-group]: https://groups.google.com/forum/#!forum/workflows-on-demand\n[vbox]: https://www.virtualbox.org/wiki/Downloads\n[mint]: http://www.linuxmint.com/download.php",
    "docs_url": null,
    "download_url": "UNKNOWN",
    "downloads": {
      "last_day": 0,
      "last_month": 0,
      "last_week": 0
    },
    "home_page": "https://github.com/childsish/sofia",
    "keywords": null,
    "license": "LICENSE.txt",
    "maintainer": null,
    "maintainer_email": null,
    "name": "sofia",
    "platform": "UNKNOWN",
    "project_url": "https://pypi.org/project/sofia/",
    "release_url": "https://pypi.org/project/sofia/1.7.2.1/",
    "requires_python": null,
    "summary": "Software for the Flexible Integration of Annotation",
    "version": "1.7.2.1"
  },
  "releases": {
    "1.6.7": [],
    "1.7.0": [
      {
        "comment_text": "",
        "digests": {
          "md5": "7af75e5bccfff4c905be979503411afa",
          "sha256": "7f2704ce88d32e6140a2b2eeb6ada9d530ec59ff8543cffd877c6fd788fb0769"
        },
        "downloads": 379,
        "filename": "sofia-1.7.0.zip",
        "has_sig": false,
        "md5_digest": "7af75e5bccfff4c905be979503411afa",
        "packagetype": "sdist",
        "python_version": "source",
        "size": 66173,
        "upload_time": "2016-05-09T15:28:37",
        "url": "https://files.pythonhosted.org/packages/8e/57/4d18a9a9473b0400beca1938f3dff1bb0654d709a35e5eaca82efa458243/sofia-1.7.0.zip"
      }
    ],
    "1.7.1": [
      {
        "comment_text": "",
        "digests": {
          "md5": "6c77bbe0b2e7c3d2b71cd8327479f682",
          "sha256": "af529d54ca84ca9af450bad214305965512722a846d1d9b5f757d26ad7546ec3"
        },
        "downloads": 109,
        "filename": "sofia-1.7.1.zip",
        "has_sig": false,
        "md5_digest": "6c77bbe0b2e7c3d2b71cd8327479f682",
        "packagetype": "sdist",
        "python_version": "source",
        "size": 461302,
        "upload_time": "2016-05-10T07:24:53",
        "url": "https://files.pythonhosted.org/packages/d5/23/e34efa828f8e14ef464f6cb608d7e7fa94c144f3500cee51e518db22d062/sofia-1.7.1.zip"
      }
    ],
    "1.7.2": [
      {
        "comment_text": "",
        "digests": {
          "md5": "e0f289d53ea509338485934bc03b452a",
          "sha256": "2e9bc1a890a73f982449b2ec65d0496fe4fff44b3dc04ff2923cda11cbb88250"
        },
        "downloads": 109,
        "filename": "sofia-1.7.2.zip",
        "has_sig": false,
        "md5_digest": "e0f289d53ea509338485934bc03b452a",
        "packagetype": "sdist",
        "python_version": "source",
        "size": 457801,
        "upload_time": "2016-05-10T19:14:19",
        "url": "https://files.pythonhosted.org/packages/5c/67/566e7c8713ece5ee9aca4d5dfd8e61e6d63dc395ec4efd5093f9567f585a/sofia-1.7.2.zip"
      }
    ],
    "1.7.2.1": [
      {
        "comment_text": "",
        "digests": {
          "md5": "2ff0423664d2fb545416cfeee064a20a",
          "sha256": "5ef316f0645f433d5c3223d129241ca9fd7ae067594dba14dee5e7521b3a7a11"
        },
        "downloads": 125,
        "filename": "sofia-1.7.2.1-py2-none-any.whl",
        "has_sig": false,
        "md5_digest": "2ff0423664d2fb545416cfeee064a20a",
        "packagetype": "bdist_wheel",
        "python_version": "2.7",
        "size": 72641,
        "upload_time": "2016-05-11T08:44:45",
        "url": "https://files.pythonhosted.org/packages/3b/f4/986c3584b68175665726423a25fc8ca9d7af50030a19bd102adda66aff65/sofia-1.7.2.1-py2-none-any.whl"
      },
      {
        "comment_text": "",
        "digests": {
          "md5": "5390af2914f71c2f4847c26099f91e49",
          "sha256": "a195bc5cd4d309bcdd7cd6238b0c00034d4e7b13595c02a4e8c4906408be2a6f"
        },
        "downloads": 130,
        "filename": "sofia-1.7.2.1.zip",
        "has_sig": false,
        "md5_digest": "5390af2914f71c2f4847c26099f91e49",
        "packagetype": "sdist",
        "python_version": "source",
        "size": 458093,
        "upload_time": "2016-05-11T08:44:37",
        "url": "https://files.pythonhosted.org/packages/9c/99/7935bebb19297253196ff61efaa1b9a8c6f4e0bfd98b2006f7bcd289a234/sofia-1.7.2.1.zip"
      }
    ]
  },
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "md5": "2ff0423664d2fb545416cfeee064a20a",
        "sha256": "5ef316f0645f433d5c3223d129241ca9fd7ae067594dba14dee5e7521b3a7a11"
      },
      "downloads": 125,
      "filename": "sofia-1.7.2.1-py2-none-any.whl",
      "has_sig": false,
      "md5_digest": "2ff0423664d2fb545416cfeee064a20a",
      "packagetype": "bdist_wheel",
      "python_version": "2.7",
      "size": 72641,
      "upload_time": "2016-05-11T08:44:45",
      "url": "https://files.pythonhosted.org/packages/3b/f4/986c3584b68175665726423a25fc8ca9d7af50030a19bd102adda66aff65/sofia-1.7.2.1-py2-none-any.whl"
    },
    {
      "comment_text": "",
      "digests": {
        "md5": "5390af2914f71c2f4847c26099f91e49",
        "sha256": "a195bc5cd4d309bcdd7cd6238b0c00034d4e7b13595c02a4e8c4906408be2a6f"
      },
      "downloads": 130,
      "filename": "sofia-1.7.2.1.zip",
      "has_sig": false,
      "md5_digest": "5390af2914f71c2f4847c26099f91e49",
      "packagetype": "sdist",
      "python_version": "source",
      "size": 458093,
      "upload_time": "2016-05-11T08:44:37",
      "url": "https://files.pythonhosted.org/packages/9c/99/7935bebb19297253196ff61efaa1b9a8c6f4e0bfd98b2006f7bcd289a234/sofia-1.7.2.1.zip"
    }
  ]
}