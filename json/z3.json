{
  "info": {
    "author": "PressLabs SRL",
    "author_email": "contact@presslabs.com",
    "bugtrack_url": null,
    "classifiers": [
      "Development Status :: 4 - Beta",
      "Environment :: Console",
      "License :: OSI Approved :: Apache Software License",
      "Topic :: System :: Archiving :: Backup",
      "Topic :: Utilities"
    ],
    "description": "# z3 a ZFS to S3 backup tool\n\n[![Build Status](https://travis-ci.org/PressLabs/z3.svg)](https://travis-ci.org/PressLabs/z3)\n\nA ZFS to S3 backup tool. This is basically plumbing around `zfs send` and `zfs receive`\nso you should have at least a basic understanding of what those commands do.\n\n## Usage\n`z3 status` will show you the current state, what snapshots you have on S3 and on the local\nzfs dataset.\n\n`z3 backup` perform full or incremental backups of your dataset.\n\n`z3 restore` restores your dataset to a certain snapshot.\n\nSee `zfs SUBCOMMAND --help` for more info.\n\n### Installing\n`pip install z3`\n\nz3 is tested on python 2.7 with latest boto 2 and boto 2.2.2 (python-boto version on Ubuntu 12.04).\n\n#### Optional dependencies\n```\n# Install pv to get some progress indication while uploading.\napt-get install pv\n\n# Install pigz to provide the pigz compressors.\napt-get install pigz\n```\n\n### Configuring\nMost options can be configured as command line flags, environment variables or in a config file,\nin that order of precedence.\nThe config file is read from `/etc/z3_backup/z3.conf` if it exists, some defaults are provided by the tool.\nBUCKET `S3_KEY_ID` and `S3_SECRET` can't be provided on the command line.\nFor a list of all options see `z3/sample.conf`.\n\nYou'll usually want z3 to only backup certain snapshots (hourly/daily/weekly).\nTo do that you can specify a `SNAPSHOT_PREFIX` (defaults to `zfs-auto-snap:daily`).\n\nDefaults for `SNAPSHOT_PREFIX` and `COMPRESSOR` can be set per filesystem like so:\n```\n[fs:tank/spam]\nSNAPSHOT_PREFIX=delicious-daily-spam\nCOMPRESSOR=pigz4\n\n[fs:tank/ham]\nSNAPSHOT_PREFIX=weekly-non-spam\n```\n\n### Dataset Size, Concurrency and Memory Usage\nSince the data is streamed from `zfs send` it gets read in to memory in chunks.\nZ3 estimates a good chunk size for you: no smaller than 5MB and large enough\nto produce at most 9999 chunks. These are S3 limitation for multipart uploads.\nHere are some example chunk sizes for different datasets:\n * 50 GiB: 5 MiB\n * 500 GIB: 53 MiB\n * 1 TiB: 110 MiB\n * 2 TiB: 220 MiB\n\nMultiply that by `CONCURRENCY` to know how much memory your upload will use.\n\n### Usage Examples\n\n#### Status\n```\n# show global options\nz3 --help\n\n# show status of backups for default dataset\nz3 status\n\n# show status for other dataset; only snapshots named daily-spam-*\nz3 --dataset tank/spam --snapshot-prefix daily-spam- status\n```\n\n#### Backup\n```\n# show backup options\nz3 backup --help\n\n# perform incremental backup the latest snapshot; use pigz4 compressor\nz3 backup --compressor pigz4 --dry-run\n# inspect the commands that would be executed\nz3 backup --compressor pigz4\n\n# perform full backup of a specific snapshot\nz3 backup --full --snapshot the-part-after-the-at-sign --dry-run\n# inspect the commands that would be executed\nz3 backup --full --snapshot the-part-after-the-at-sign\n```\n\n#### Restore\n```\n# see restore options\nz3 restore --help\n\n# restore a dataset to a certain snapshot\nz3 restore the-part-after-the-at-sign --dry-run\n# inspect the commands that would be executed\nz3 restore the-part-after-the-at-sign\n\n# force rollback of filesystem (zfs recv -F)\nz3 restore the-part-after-the-at-sign --force\n```\n\n### Other Commands\nOther command line tools are provided.\n\n`pput` reads a stream from standard in and uploads the data to S3.\n\n`z3_ssh_sync` a convenience tool to allow you to push zfs snapshots to another host.\nIf you need replication you should checkout zrep. This exists because we've already\ngot zrep between 2 nodes and needed a way to push backups to a 3rd machine.\n\n`z3_get` called by `z3 restore` to download a backup.\n\n## Development Overview\n### Running the tests\nThe test suite uses pytest.\nSome of the tests upload data to S3, so you need to setup the following environment:\n```\nexport S3_KEY_ID=\"\"\nexport S3_SECRET=\"\"\nexport BUCKET=\"mytestbucket\"\n```\n\nTo skip tests that use S3:\n```\npy.test --capture=no --tb=native _tests/ -k \"not with_s3\"\n```\n\n### The Data\nSnapshots are obtained using `zfs send`, optionally piped trough a compressor (pigz by default),\nand finally piped to `pput`.\nIncremental snapshots are always handled individually, so if you have multiple snapshots to send\nsince the last time you've performed a backup they get exported as individual snapshots\n(multiple calls to `zfs send -i dataset@snapA dataset@snapB`).\n\nYour snapshots end up as individual keys in an s3 bucket, with a configurable prefix (`S3_PREFIX`).\nS3 key metadata is used to identify if a snapshot is full (`is_full=\"true\"`) or incremental.\nThe parent of an incremental snapshot is identified with the `parent` attribute.\n\nS3 and ZFS snapshots are matched by name.\n\n### Health checks\nThe S3 health checks are very rudimentary, basically if a snapshot is incremental check\nthat the parent exists and is healthy. Full backups are always assumed healthy.\n\nIf backup/restore encounter unhealthy snapshots they abort execution.\n\n### pput\npput is a simple tool with one job, read data from stdin and upload it to S3.\nIt's usually invoked by z3.\n\nConsistency is important, it's better to fail hard when something goes wrong\nthan silently upload inconsistent or partial data.\nThere are few anticipated errors (if a part fails to upload, retry MAX_RETRY times).\nAny other problem is unanticipated, so just let the tool crash.\n\nTL;DR Fail early, fail hard.\n",
    "docs_url": null,
    "download_url": "UNKNOWN",
    "downloads": {
      "last_day": 0,
      "last_month": 0,
      "last_week": 0
    },
    "home_page": "https://github.com/presslabs/z3",
    "keywords": "ZFS backup",
    "license": "UNKNOWN",
    "maintainer": null,
    "maintainer_email": null,
    "name": "z3",
    "platform": "any",
    "project_url": "https://pypi.org/project/z3/",
    "release_url": "https://pypi.org/project/z3/0.1.14/",
    "requires_python": null,
    "summary": "Backup ZFS snapshots to S3",
    "version": "0.1.14"
  },
  "releases": {
    "0.1.10": [
      {
        "comment_text": "",
        "digests": {
          "md5": "f9b7f7101602a785d200240457fd7428",
          "sha256": "f2bbdd01179a8a7842e21a30f95c2b34ce072b86994147b37365ddf8f8f2c615"
        },
        "downloads": 190,
        "filename": "z3-0.1.10.tar.gz",
        "has_sig": false,
        "md5_digest": "f9b7f7101602a785d200240457fd7428",
        "packagetype": "sdist",
        "python_version": "source",
        "size": 23297,
        "upload_time": "2016-03-25T15:57:37",
        "url": "https://files.pythonhosted.org/packages/94/8a/a62e9a40dff7563726c64010327f7abbcf29b6efdfcabc573c48019ba798/z3-0.1.10.tar.gz"
      }
    ],
    "0.1.11": [
      {
        "comment_text": "",
        "digests": {
          "md5": "24fa65a0d7996db2286bb154252883e0",
          "sha256": "e9971d250e80f2a03e4b65d405a560ffbfc32ef23fc664b54f0aecbe977f8988"
        },
        "downloads": 191,
        "filename": "z3-0.1.11.tar.gz",
        "has_sig": false,
        "md5_digest": "24fa65a0d7996db2286bb154252883e0",
        "packagetype": "sdist",
        "python_version": "source",
        "size": 23453,
        "upload_time": "2016-03-25T16:38:12",
        "url": "https://files.pythonhosted.org/packages/12/4b/81b4e4c9575a009897c0f28073f4ca81e67b059844fca875d3b1472700fd/z3-0.1.11.tar.gz"
      }
    ],
    "0.1.12": [
      {
        "comment_text": "",
        "digests": {
          "md5": "a39d2dd64b20574d81e80b2e18525b22",
          "sha256": "922f9d8e6be606b0df1ffd694b7e0a47f0cb7d823abd5bcf415b5d38b7c03e9b"
        },
        "downloads": 513,
        "filename": "z3-0.1.12.tar.gz",
        "has_sig": false,
        "md5_digest": "a39d2dd64b20574d81e80b2e18525b22",
        "packagetype": "sdist",
        "python_version": "source",
        "size": 24013,
        "upload_time": "2016-03-30T14:25:12",
        "url": "https://files.pythonhosted.org/packages/fc/d3/dfaca3722e778fe7a93a121e369a4e41f261c69671ff3137dd964c3650a1/z3-0.1.12.tar.gz"
      }
    ],
    "0.1.13": [
      {
        "comment_text": "",
        "digests": {
          "md5": "f6add9382b5f3f3600b99658cad22117",
          "sha256": "8eb22b403189aad836578f83f163838c290da83c6aa19f0d31290e85d69254da"
        },
        "downloads": 544,
        "filename": "z3-0.1.13.tar.gz",
        "has_sig": false,
        "md5_digest": "f6add9382b5f3f3600b99658cad22117",
        "packagetype": "sdist",
        "python_version": "source",
        "size": 24182,
        "upload_time": "2016-04-01T15:16:10",
        "url": "https://files.pythonhosted.org/packages/f5/95/ea3100d5169c063141b9fb18e8babe588a61085bed1ea74df32f64e6c6a9/z3-0.1.13.tar.gz"
      }
    ],
    "0.1.14": [
      {
        "comment_text": "",
        "digests": {
          "md5": "bb3b38d698e2b6010a3da0865388f81b",
          "sha256": "4ad1c800004022e085911f4a632fba65f8abb42e6409b17af6b6a0bdefdce40b"
        },
        "downloads": 474,
        "filename": "z3-0.1.14.tar.gz",
        "has_sig": false,
        "md5_digest": "bb3b38d698e2b6010a3da0865388f81b",
        "packagetype": "sdist",
        "python_version": "source",
        "size": 23942,
        "upload_time": "2016-11-25T07:04:16",
        "url": "https://files.pythonhosted.org/packages/28/9b/3c163ce50be5a4f8444dc50495b6b82bff2ffc379bb7aba54a72011b2977/z3-0.1.14.tar.gz"
      }
    ],
    "0.1.2": [
      {
        "comment_text": "",
        "digests": {
          "md5": "d031684bab2d449d1b9b862657321540",
          "sha256": "d5c83d4a5635687b8c40b3810762466596899fa3c84f6111f97eec0255a0e918"
        },
        "downloads": 317,
        "filename": "z3-0.1.2.tar.gz",
        "has_sig": false,
        "md5_digest": "d031684bab2d449d1b9b862657321540",
        "packagetype": "sdist",
        "python_version": "source",
        "size": 18868,
        "upload_time": "2016-02-02T09:55:11",
        "url": "https://files.pythonhosted.org/packages/c6/d0/52ea4609152b5884688f0c3277a0f7ab793ce52dd4fee0a2807f425fb4de/z3-0.1.2.tar.gz"
      }
    ],
    "0.1.3": [
      {
        "comment_text": "",
        "digests": {
          "md5": "09839d79c0ee41604017898e95a15c19",
          "sha256": "11c89c3ea16072441d71adc2732a2ac8a2bc9a4cd87cc2364e9289bf63ce08d0"
        },
        "downloads": 193,
        "filename": "z3-0.1.3.tar.gz",
        "has_sig": false,
        "md5_digest": "09839d79c0ee41604017898e95a15c19",
        "packagetype": "sdist",
        "python_version": "source",
        "size": 20482,
        "upload_time": "2016-02-15T19:26:46",
        "url": "https://files.pythonhosted.org/packages/6d/b4/a3e5de3c7e2e2e5f24878482e2464ada65c2005f4a28592012b51e026ec7/z3-0.1.3.tar.gz"
      }
    ],
    "0.1.4": [
      {
        "comment_text": "",
        "digests": {
          "md5": "2c7621c9ececb6b32c6373e2301386c5",
          "sha256": "bd862fe978aa54e79756dbf5deaa4c4d463277225796539159e96af2ee81711d"
        },
        "downloads": 207,
        "filename": "z3-0.1.4.tar.gz",
        "has_sig": false,
        "md5_digest": "2c7621c9ececb6b32c6373e2301386c5",
        "packagetype": "sdist",
        "python_version": "source",
        "size": 20917,
        "upload_time": "2016-02-16T09:38:37",
        "url": "https://files.pythonhosted.org/packages/8a/aa/52518172e1b3c6fbe0386d43bed9b5279fe843d545b97d08e78b14551cc7/z3-0.1.4.tar.gz"
      }
    ],
    "0.1.5": [
      {
        "comment_text": "",
        "digests": {
          "md5": "5c2295b75ec7a1a392e403261d17ce53",
          "sha256": "ab945f99e744030a4a80120e052629b4696052578a6b1555ed108d840f7cd3a5"
        },
        "downloads": 206,
        "filename": "z3-0.1.5.tar.gz",
        "has_sig": false,
        "md5_digest": "5c2295b75ec7a1a392e403261d17ce53",
        "packagetype": "sdist",
        "python_version": "source",
        "size": 20930,
        "upload_time": "2016-02-23T17:46:49",
        "url": "https://files.pythonhosted.org/packages/14/7e/6ad79d7a64660f7a3851c809a4561e75190e30033e5c95913e33e922ae2d/z3-0.1.5.tar.gz"
      }
    ],
    "0.1.6": [
      {
        "comment_text": "",
        "digests": {
          "md5": "69590f0da77077752ebf3d7b5fc121b7",
          "sha256": "67d266d6ecd909483e0fb35ebb79730366a5bac53e62dc915d2754a245aab6bd"
        },
        "downloads": 188,
        "filename": "z3-0.1.6.tar.gz",
        "has_sig": false,
        "md5_digest": "69590f0da77077752ebf3d7b5fc121b7",
        "packagetype": "sdist",
        "python_version": "source",
        "size": 21121,
        "upload_time": "2016-02-26T12:27:28",
        "url": "https://files.pythonhosted.org/packages/6d/26/48b855a525674558f96309606d23f6244f8664d6a042b4defea3faf4e69b/z3-0.1.6.tar.gz"
      }
    ],
    "0.1.7": [
      {
        "comment_text": "",
        "digests": {
          "md5": "738486c5f96ae1cc2b95fc7325f7ef95",
          "sha256": "d523b037bd2d9e315da968ac46d6387a2521d63c6bc3091cd4a8beed2650ebc9"
        },
        "downloads": 210,
        "filename": "z3-0.1.7.tar.gz",
        "has_sig": false,
        "md5_digest": "738486c5f96ae1cc2b95fc7325f7ef95",
        "packagetype": "sdist",
        "python_version": "source",
        "size": 21135,
        "upload_time": "2016-03-01T13:36:30",
        "url": "https://files.pythonhosted.org/packages/7d/b7/ef2a5c90c0989f124787bb0a22a142c94d010e21d78915f0d26ce790b2a7/z3-0.1.7.tar.gz"
      }
    ],
    "0.1.8": [
      {
        "comment_text": "",
        "digests": {
          "md5": "6c07eced7edcd8d86274e5a6ac3d25d1",
          "sha256": "afde4eeddf9adbc251210620dc80e5a207bb6f056ab2bb4491b7e39a02247b88"
        },
        "downloads": 189,
        "filename": "z3-0.1.8.tar.gz",
        "has_sig": false,
        "md5_digest": "6c07eced7edcd8d86274e5a6ac3d25d1",
        "packagetype": "sdist",
        "python_version": "source",
        "size": 21916,
        "upload_time": "2016-03-10T15:03:47",
        "url": "https://files.pythonhosted.org/packages/fc/54/42e9eb5f683ed164e0206217f4a20734119bc61c2a367c1479435d1228ec/z3-0.1.8.tar.gz"
      }
    ],
    "0.1.9": [
      {
        "comment_text": "",
        "digests": {
          "md5": "7707947c0b3fdd476a90fe9b1d9d7ebd",
          "sha256": "e0eccb41de1af96b4344f0d024dfb99f0a2356c913045c243d7b6ea80a1b8505"
        },
        "downloads": 204,
        "filename": "z3-0.1.9.tar.gz",
        "has_sig": false,
        "md5_digest": "7707947c0b3fdd476a90fe9b1d9d7ebd",
        "packagetype": "sdist",
        "python_version": "source",
        "size": 21870,
        "upload_time": "2016-03-10T15:21:32",
        "url": "https://files.pythonhosted.org/packages/9e/5b/8381a773c80a14c5e1c3454dbca616f87c875d1f33ea461bcc9650f4d220/z3-0.1.9.tar.gz"
      }
    ]
  },
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "md5": "bb3b38d698e2b6010a3da0865388f81b",
        "sha256": "4ad1c800004022e085911f4a632fba65f8abb42e6409b17af6b6a0bdefdce40b"
      },
      "downloads": 474,
      "filename": "z3-0.1.14.tar.gz",
      "has_sig": false,
      "md5_digest": "bb3b38d698e2b6010a3da0865388f81b",
      "packagetype": "sdist",
      "python_version": "source",
      "size": 23942,
      "upload_time": "2016-11-25T07:04:16",
      "url": "https://files.pythonhosted.org/packages/28/9b/3c163ce50be5a4f8444dc50495b6b82bff2ffc379bb7aba54a72011b2977/z3-0.1.14.tar.gz"
    }
  ]
}