{
  "info": {
    "author": "Wentao Liang",
    "author_email": "tonnie17@gmail.com",
    "bugtrack_url": null,
    "classifiers": [],
    "description": "# flowlight\n[![Build Status](https://travis-ci.org/tonnie17/flowlight.svg?branch=master)](https://travis-ci.org/tonnie17/flowlight)\n\na tool make remote operations easier\n\n## Install\n\n```\npip3 install git+git://github.com/tonnie17/flowlight.git@master\n```\n\n## RPC Worker Mode\n\nlauch flowlight workers.\n\n```\n$flowlight worker start\n```\n\ndo some works on remote workers.\n\n```python\nfrom flowlight import Machine\n\ndef compute(*args, **kwargs):\n    return sum(args)\n\nm = Machine('127.0.0.1')\nprint (m.run_remote_callable(compute, 1, 2, 3))\n# b'6'\n```\n\nstop workers.\n\n```\n$flowlight worker stop\n```\n\nshow workers status\n\n```\n$flowlight worker status\n```\n\n## API Mode\n\n```\n$flowlight api\nFlowLight API serve on 3601...\n Usage:: http://127.0.0.1:3601/<machines>/<command>\n```\n\nRun command via URL.\n\n```\nhttp -f GET \"http://127.0.0.1:3601/127.0.0.1/whoami\"\n```\n\noutput:\n\n```html\n<h1>127.0.0.1</h1><pre>tonnie\n</pre>\n```\n\nmultiple executions.\n\n```\nhttp -f GET \"http://127.0.0.1:3601/host1,host2/ps aux|wc -l\"\n```\n\noutput:\n\n```html\n<h1>host1</h1><pre>     122\n</pre>\n<h1>host2</h1><pre>     118\n</pre>\n```\n\nJSON format.\n\n```\nhttp -f GET \"http://127.0.0.1:3601/host1/uptime?format=json\"\n```\n\noutput:\n\n```json\n[{\"result\": \" 15:54:06 up 97 days,  5:43,  3 users,  load average: 0.31, 0.45, 0.49\\n\", \"host\": \"172.22.31.114\"}]\n```\n\n## Usage\n\nRun task via ssh on remote machines.\n\n```python\nfrom flowlight import Cluster, Group, task\n\ncluster = Cluster(['host1', Group(['host2', 'host3'])])\ncluster.set_connection(password='password')\n\n@task\ndef create_file(task, cluster):\n    responses = cluster.run('''\n    echo {value} > /tmp/test;\n        '''.format(value=task.value)\n    )\n    task.value += 1\n\n@create_file.on_start\ndef before_create_file(task):\n    task.value = 1\n\n@create_file.on_complete\ndef after_create_file(task):\n    print(task.value)\n\n@create_file.on_error\ndef error_when_create_file(exception):\n    print(exception)\n    import traceback\n    traceback.print_exc()\n\ncluster.run_task(create_file)\n```\n\noutput:\n\n```\n2\n```\n\nUse `run_after` to set order of tasks.\n\n```python\n@task(run_after=create_file)\ndef show_file(meta, cluster):\n    responses = cluster.run('''\n        cat /tmp/test;            \n    ''')\n    for res in responses:\n        print(res)\n\ncluster.run_task(show_file)\n```\n\nUse trigger in multi-threading.\n\n```python\nimport threading\nfrom time import sleep\nafter = threading.Thread(target=lambda: cluster.run_task(show_file))\nbefore = threading.Thread(target=lambda: cluster.run_task(create_file))\nafter.start()\nprint('sleep a while...')\nsleep(2)\nbefore.start()\nbefore.join()\nafter.join()\n```\n\noutput:\n\n```\nsleep a while...\n2\n1\n\n1\n\n1\n```\n\nUse `run_only` for task running pre-check.\n\n```python\n@task(run_only=lambda: 1 > 2)\ndef fail_task(self):\n    print('condition is passed')\n\nerr, status = cluster.run_task(fail_task)\n```\n\nAsync tasks supported.\n\n```python\nasync def async_task(machine):\n    response = await machine.run_async(\"ls\")\n    return response\n\nm = Machine('host1', connect=True)\nm2 = Machine('host2', connect=True)\n\nev_loop = asyncio.get_event_loop()\nev_loop.run_until_complete(asyncio.gather(\n    async_task(m), async_task(m2)\n))\nev_loop.close()\n```\n\nFile upload & download\n\n```python\nm = Machine('host1', connect=True)\nm.put('/tmp/remote_file', '/tmp/local_file') # upload\nm.get('/tmp/local_file', '/tmp/remote_file') # download\n```\n",
    "docs_url": null,
    "download_url": "",
    "downloads": {
      "last_day": 0,
      "last_month": 0,
      "last_week": 0
    },
    "home_page": "http://github.com/tonnie17/flowlight/",
    "keywords": "",
    "license": "MIT",
    "maintainer": "",
    "maintainer_email": "",
    "name": "flowlight",
    "platform": "",
    "project_url": "https://pypi.org/project/flowlight/",
    "release_url": "https://pypi.org/project/flowlight/0.1.4/",
    "requires_python": "",
    "summary": "a tool make remote operations easier",
    "version": "0.1.4"
  },
  "releases": {
    "0.1.2": [
      {
        "comment_text": "",
        "digests": {
          "md5": "018351e0d811e79cb1d1b1f9d4e7674f",
          "sha256": "f64608f767419bc440e53ce87393f7353d15b5a676e0481eb32a7044b26e16ad"
        },
        "downloads": 11,
        "filename": "flowlight-0.1.2.tar.gz",
        "has_sig": false,
        "md5_digest": "018351e0d811e79cb1d1b1f9d4e7674f",
        "packagetype": "sdist",
        "python_version": "source",
        "size": 7721,
        "upload_time": "2017-02-27T08:36:38",
        "url": "https://files.pythonhosted.org/packages/51/a0/efbc4b8a104da0f86e6cf69d7492052ef4b44fc4197d062772ec92900d76/flowlight-0.1.2.tar.gz"
      }
    ],
    "0.1.3": [
      {
        "comment_text": "",
        "digests": {
          "md5": "b138bc6270f7220b20801aecca107581",
          "sha256": "0bc2eebb77f191a4caa23aada841f9d38965c0b81fd2a600f28f4080c8c24f45"
        },
        "downloads": 13,
        "filename": "flowlight-0.1.3.tar.gz",
        "has_sig": false,
        "md5_digest": "b138bc6270f7220b20801aecca107581",
        "packagetype": "sdist",
        "python_version": "source",
        "size": 7856,
        "upload_time": "2017-02-28T10:56:34",
        "url": "https://files.pythonhosted.org/packages/c9/b1/abd0f2684c31d4e55db33fa1d5e261186c3945c708c501488b310dcd3bf4/flowlight-0.1.3.tar.gz"
      }
    ],
    "0.1.4": [
      {
        "comment_text": "",
        "digests": {
          "md5": "692552b2e69fb2686e69d6382e7964a8",
          "sha256": "b3cd6bfee6db1604c63c762b246ee88211ea502ec6a695231818f368801f9d88"
        },
        "downloads": 0,
        "filename": "flowlight-0.1.4.tar.gz",
        "has_sig": false,
        "md5_digest": "692552b2e69fb2686e69d6382e7964a8",
        "packagetype": "sdist",
        "python_version": "source",
        "size": 12545,
        "upload_time": "2017-05-12T15:05:50",
        "url": "https://files.pythonhosted.org/packages/2a/b7/98bf37f387f07d643a8c27572ccae0cbc5a1b69e9d206172fc8d382c6ff2/flowlight-0.1.4.tar.gz"
      }
    ]
  },
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "md5": "692552b2e69fb2686e69d6382e7964a8",
        "sha256": "b3cd6bfee6db1604c63c762b246ee88211ea502ec6a695231818f368801f9d88"
      },
      "downloads": 0,
      "filename": "flowlight-0.1.4.tar.gz",
      "has_sig": false,
      "md5_digest": "692552b2e69fb2686e69d6382e7964a8",
      "packagetype": "sdist",
      "python_version": "source",
      "size": 12545,
      "upload_time": "2017-05-12T15:05:50",
      "url": "https://files.pythonhosted.org/packages/2a/b7/98bf37f387f07d643a8c27572ccae0cbc5a1b69e9d206172fc8d382c6ff2/flowlight-0.1.4.tar.gz"
    }
  ]
}